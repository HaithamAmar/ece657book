\documentclass[11pt,twoside]{article}
        % KDP print layout: 7x10 in trim, mirrored margins with generous gutter for a long book
        \usepackage[
          paperwidth=7in,
          paperheight=10in,
          inner=1in,
          outer=0.75in,
          top=0.75in,
          bottom=0.8in,
          includehead,
          includefoot
        ]{geometry}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{physics}
\usepackage{siunitx}
\usepackage{hyperref}
\usepackage{cleveref}
% Cross-reference naming (this manuscript uses top-level \section as "Chapter")
\crefname{section}{Chapter}{Chapters}
\Crefname{section}{Chapter}{Chapters}
\crefname{subsection}{Section}{Sections}
\Crefname{subsection}{Section}{Sections}
\crefname{subsubsection}{Section}{Sections}
\Crefname{subsubsection}{Section}{Sections}
\crefname{figure}{Figure}{Figures}
\Crefname{figure}{Figure}{Figures}
\crefname{table}{Table}{Tables}
\Crefname{table}{Table}{Tables}
\crefname{equation}{Equation}{Equations}
\Crefname{equation}{Equation}{Equations}
% Prefer compact ranges like "Chapters 2--5" (guard for older cleveref versions).
\makeatletter
\@ifundefined{crefrangeconjunction}{}{%
  \renewcommand{\crefrangeconjunction}{--}%
}
\makeatother
\usepackage{hyphenat} % for \hyp to keep hyphenated terms unbroken
        \usepackage{enumitem}
        \setlist{itemsep=0.25em, topsep=0.25em}
\usepackage{graphicx}
\usepackage{adjustbox}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{subcaption}
\captionsetup{justification=centering,singlelinecheck=false}
\captionsetup[figure]{width=0.9\linewidth}
% Timestamp marker for rebuilds
% (No effect on content; used to force fresh PDF generation when needed.)
\usepackage{microtype}
        % Typography and layout tuning
        \usepackage{setspace}
        \setstretch{1.15}
        \usepackage{titlesec}
        % Increase spacing before/after headings
        \titlespacing*{\section}{0pt}{*3}{*1.5}
        \titlespacing*{\subsection}{0pt}{*2}{*1}
        \titlespacing*{\subsubsection}{0pt}{*1.5}{*0.8}
        % Running headers/footers
        \usepackage{fancyhdr}
        \pagestyle{fancy}
        \fancyhf{}
        \fancyhead[L]{\small Modern Intelligent Systems}
        % Short running heads: show only the section number to avoid overlap with long titles
        \fancyhead[R]{\small \nouppercase{\leftmark}}
        \fancyfoot[C]{\thepage}
        \renewcommand{\sectionmark}[1]{\markboth{\thesection}{}}
        \setlength{\headheight}{26pt}
        \setlength{\headsep}{24pt}
        \usepackage{placeins}
        \usepackage{xcolor}
        \usepackage{bookmark}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows.meta,decorations.pathreplacing,calc,shapes.geometric,matrix,quotes,backgrounds}
\pgfdeclarelayer{background}
\usepackage{pgfplots}
\usepackage[authoryear]{natbib}
\usepackage[most]{tcolorbox}
\makeatletter
\AtBeginDocument{%
  \@ifundefined{pgf@layer@tcb@back}{%
    \pgfsetlayers{background,main}%
  }{%
    \pgfsetlayers{background,tcb@back,main,tcb@front}%
  }%
}%
\newcommand{\ensuretikzbackgroundlayers}{%
  \@ifundefined{pgf@layer@tcb@back}{%
    \pgfsetlayers{background,main}%
  }{%
    \pgfsetlayers{background,tcb@back,main,tcb@front}%
  }%
}%
\makeatother
\usepgfplotslibrary{groupplots,fillbetween}
\pgfplotsset{compat=1.18}
        % Avoid vertically stretched pages when content is sparse
        \raggedbottom
        % Relax line breaking to reduce overfull hboxes in dense prose
        \emergencystretch=2em
        % Equation numbering by section and display spacing
        \numberwithin{equation}{section}
        \setlength{\abovedisplayskip}{10pt}
        \setlength{\belowdisplayskip}{10pt}
        \setlength{\abovedisplayshortskip}{6pt}
        \setlength{\belowdisplayshortskip}{6pt}

        % Global plot styling for consistency across figures
        \pgfplotsset{every axis/.append style={
            tick label style={font=\scriptsize},
            label style={font=\small},
            legend style={font=\scriptsize, fill=none, draw=none, at={(0.5,-0.15)}, anchor=north},
            line width=0.9pt,
            grid=both,
            grid style={gray!15}
        }}
        \definecolor{cbBlue}{RGB}{0,114,178}
        \definecolor{cbOrange}{RGB}{230,159,0}
        \definecolor{cbGreen}{RGB}{0,158,115}
        \definecolor{cbPink}{RGB}{213,94,0}
        \definecolor{cbGray}{gray}{0.45}
        \pgfplotscreateplotcyclelist{cbPalette}{%
            {cbBlue, mark=*, mark options={scale=0.6,solid}},
            {cbOrange, mark=square*, mark options={scale=0.6,solid}},
            {cbGreen, mark=triangle*, mark options={scale=0.6,solid}},
            {cbPink, mark=diamond*, mark options={scale=0.6,solid}}
        }
        \pgfplotsset{cycle list name=cbPalette}

        % TikZ "switch" style (used for GRU diagram)
        \makeatletter
        \newif\ifswitch@open
        \newif\ifswitch@swap
        \pgfkeys{
            /switch/.cd,
                open/.is if=switch@open,
                open=true,
                closed/.code=\pgfkeysalso{open=false},
                swap/.is if=switch@swap,
        }
        \tikzset{
            switch/.style={
                sloped,
                allow upside down,
                midway,
                inner sep=0pt,
                minimum height=7mm+0.5\pgflinewidth,
                minimum width=8mm+2\pgflinewidth+2pt,
                node contents={},
                prefix after command={
                    \pgfextra{
                        \tikzset{
                            every label/.style={shift={(switch@label@coor)}},
                        }
                    }
                },
                path picture={
                    \ifswitch@open
                        \draw[white,line width=2\pgflinewidth] (-0.4,0) -- (0.4,0);
                        \ifswitch@swap
                            \draw (-0.4,0) -- ++(-25:0.8);
                        \else
                            \draw (-0.4,0) -- ++(25:0.8);
                        \fi
                    \fi
                    \fill (-0.4,0) coordinate (switch@label@coor)
                          circle (1pt+\pgflinewidth);
                    \fill ( 0.4,0) circle (1pt+\pgflinewidth);
                },
            },
            switch/.prefix code={\pgfkeys{/switch/.cd,#1}},
        }
        \makeatother

        % Summary / pitfall box styles
        \tcbset{summarybox/.style={colback=gray!5,colframe=gray!40,boxrule=0.4pt,arc=1mm,left=2mm,right=2mm,top=1mm,bottom=1mm,fonttitle=\bfseries,title=Summary,before upper=\raggedright}}
        \tcbset{pitfallbox/.style={colback=red!3,colframe=red!40,boxrule=0.4pt,arc=1mm,left=2mm,right=2mm,top=1mm,bottom=1mm,fonttitle=\bfseries,title=Pitfall,before upper=\raggedright}}
\tcbset{perspectivebox/.style={colback=blue!3,colframe=blue!40,boxrule=0.4pt,arc=1mm,left=2mm,right=2mm,top=1mm,bottom=1mm,fonttitle=\bfseries,title=Perspective,before upper=\raggedright}}

\makeatletter
\newcommand{\chapnum}[2]{%
  \@ifundefined{r@#1}{#2}{\ref{#1}}}
\newcommand{\ChapterRef}[2]{Chapter~\chapnum{#1}{#2}}
\newcommand{\ChaptersRef}[4]{Chapters~\chapnum{#1}{#2}--\chapnum{#3}{#4}}
\newcommand{\ChapterOnly}[2]{\chapnum{#1}{#2}}
\makeatother

\setcounter{secnumdepth}3
\setcounter{tocdepth}2

\makeatletter
% ---- Publishing polish: TOC/LOF/LOT spacing ----
% The default `article` widths are tight once page numbers hit 3 digits and
% subsection numbers grow (e.g., 19.25). These tweaks prevent number/title
% collisions and make dotted leaders read cleanly.
\renewcommand\@pnumwidth{3em}
\renewcommand\@tocrmarg{4em}
\renewcommand*\l@subsection{\@dottedtocline{2}{1.5em}{3.2em}}
\renewcommand*\l@subsubsection{\@dottedtocline{3}{3.8em}{4.2em}}
\makeatother

        \title{Modern Intelligent Systems: A Graduate Companion\\\large Neural Networks, Fuzzy Logic, and Evolutionary Optimization}
        \author{Haitham Amar}
        % For a book-style companion, omit the day-level timestamp on the title page.
        % Edition/year for the title page. Update this string for future printings.
        \date{First edition, 2026}
        \hypersetup{
            pdftitle={Modern Intelligent Systems: A Graduate Companion},
            pdfauthor={Haitham Amar},
            hidelinks
        }

        \begin{document}
        \maketitle
        \thispagestyle{empty}
        \clearpage
        \input{copyright.tex}
        \pagestyle{fancy}
        \input{preface.tex}
        \newpage
        \input{acknowledgments.tex}
        \newpage
\tableofcontents
\newpage
\listoffigures
\newpage
\listoftables
\newpage
% Notation / Glossary
        \input{notation.tex}
        \newpage

	        \input{book_chapters.tex}
\newpage
\part*{Back matter}
\addcontentsline{toc}{part}{Back matter}
\newpage
\input{key_takeaways.tex}
\FloatBarrier
\newpage
\input{book_bibliography.tex}

\newpage
% Appendices
\input{book_appendices.tex}

        \end{document}
